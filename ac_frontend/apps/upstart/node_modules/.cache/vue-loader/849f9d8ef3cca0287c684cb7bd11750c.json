{"remainingRequest":"D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\src\\components\\AdminSubscriberCard.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\src\\components\\AdminSubscriberCard.vue","mtime":1606618313551},{"path":"D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQoNCg0KaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsNCmltcG9ydCB7ZGVmYXVsdCBhcyBBUElfRU5EUE9JTlRTfSBmcm9tICJAL2FwaSI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIlN1YnNjcmliZXJDYXJkIiwNCiAgY29tcG9uZW50czoge30sDQogIHByb3BzOiBbDQogICAgJ3Byb2plY3RJZCcsDQogICAgJ2VtYWlsJywNCiAgICAnc3Vic2NyaWJlcicsDQogICAgJ2lzRWRpdGluZycNCiAgXSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgc3Vic2NyaWJlckNvcHk6IHt9LA0KICAgICAgZW1haWxSdWxlczogWw0KICAgICAgICB2ID0+ICEhdiB8fCAiUmVxdWlyZWQiLA0KICAgICAgICB2ID0+IC8uK0AuK1wuLisvLnRlc3QodikgfHwgIkUtbWFpbCBtdXN0IGJlIHZhbGlkIg0KICAgICAgXSwNCiAgICAgIGFydGljbGVDdXJzb3JSdWxlczogWw0KICAgICAgICB2ID0+ICEhdiB8fCAiUmVxdWlyZWQiLA0KICAgICAgICB2ID0+IC9eXGQrJC8udGVzdCh2KSB8fCAiQXJ0aWNsZSBOby4gbXVzdCBiZSBhIG51bWJlciINCiAgICAgIF0sDQogICAgICBzaG93TWVzc2FnZTogZmFsc2UsDQogICAgICBkaXNwbGF5ZWRNZXNzYWdlOiAiIiwNCiAgICAgIHN1YnNjcmliZXJTdGF0dXM6IFsNCiAgICAgICAge29wdGlvbjogIkVuYWJsZWQiLCB2YWx1ZTogdHJ1ZX0sDQogICAgICAgIHtvcHRpb246ICJEaXNhYmxlZCIsIHZhbHVlOiBmYWxzZX0NCiAgICAgIF0NCiAgICB9DQogIH0sDQogIGNvbXB1dGVkOiB7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBjbG9zZSgpIHsNCiAgICAgIHRoaXMuJGVtaXQoJ2Nsb3NlJykNCiAgICB9LA0KICAgIGNsb3NlU2hvd01lc3NhZ2UoKSB7DQogICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgdGhpcy5zaG93TWVzc2FnZSA9IGZhbHNlDQogICAgICB9LCA2MDAwKQ0KICAgIH0sDQogICAgaXNFbWFpbFZhbGlkKGVtYWlsKSB7DQogICAgICBpZiAoISgvLitALitcLi4rLy50ZXN0KGVtYWlsKSkpIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICB9DQogICAgICByZXR1cm4gdHJ1ZQ0KICAgIH0sDQogICAgaXNBcnRpY2xlQ3Vyc29yVmFsaWQoYXJ0aWNsZU51bWJlcikgew0KICAgICAgaWYgKCEoL15cZCskLy50ZXN0KGFydGljbGVOdW1iZXIpKSkgew0KICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgIH0NCiAgICAgIHJldHVybiB0cnVlDQogICAgfSwNCiAgICBzYXZlKCkgew0KICAgICAgaWYgKCF0aGlzLmlzQXJ0aWNsZUN1cnNvclZhbGlkKHRoaXMuc3Vic2NyaWJlckNvcHkuYXJ0aWNsZUN1cnNvcikpIHsNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgICB0aGlzLnNhdmVTdWJzY3JpYmVyKCkNCiAgICB9LA0KICAgIGFkZCgpIHsNCiAgICAgIGlmICghdGhpcy5pc0VtYWlsVmFsaWQodGhpcy5zdWJzY3JpYmVyQ29weS5lbWFpbCkpIHsNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgICB0aGlzLnN1YnNjcmliZSgpDQogICAgfSwNCiAgICBzdWJzY3JpYmUoKSB7DQogICAgICBjb25zdCBkYXRhID0ge3Byb2plY3RJZDogdGhpcy5wcm9qZWN0SWQsIGVtYWlsOiB0aGlzLnN1YnNjcmliZXJDb3B5LmVtYWlsLCBmaXJzdE5hbWU6ICcnLCBsYXN0TmFtZTogJyd9DQogICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsNCiAgICAgICAgYXhpb3Moe3VybDogQVBJX0VORFBPSU5UUy5DUkVBVEVfU1VCU0NSSUJFUiwgZGF0YTogZGF0YSwgbWV0aG9kOiAnUE9TVCd9KQ0KICAgICAgICAgICAgLnRoZW4ocmVzcCA9PiB7DQogICAgICAgICAgICAgIHJlc29sdmUocmVzcCkNCiAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5ZWRNZXNzYWdlID0gIlN1YnNjcmliZWQgc3VjY2Vzc2Z1bGx5ISINCiAgICAgICAgICAgICAgdGhpcy5zaG93TWVzc2FnZSA9IHRydWUNCiAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVyQ29weS5lbWFpbCA9ICIiDQogICAgICAgICAgICAgIHRoaXMuY2xvc2VTaG93TWVzc2FnZSgpDQogICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3N1YnNjcmliZXJBZGRlZCcsIChyZXNwLmRhdGEpKQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuZGlzcGxheWVkTWVzc2FnZSA9ICJGYWlsZWQgdG8gc3Vic2NyaWJlLiINCiAgICAgICAgICAgICAgdGhpcy5zaG93TWVzc2FnZSA9IHRydWUNCiAgICAgICAgICAgICAgdGhpcy5jbG9zZVNob3dNZXNzYWdlKCkNCiAgICAgICAgICAgIH0pDQogICAgICB9KQ0KICAgIH0sDQogICAgc2F2ZVN1YnNjcmliZXIoKSB7DQogICAgICBjb25zdCBkYXRhID0gew0KICAgICAgICBlbWFpbDogdGhpcy4kc3RvcmUuZ2V0dGVycy5lbWFpbCwgLy9hZG1pbiBlbWFpbA0KICAgICAgICBlZGl0ZWRTdWJzY3JpYmVyOiB7DQogICAgICAgICAgcHJvamVjdElkOiB0aGlzLnByb2plY3RJZCwNCiAgICAgICAgICBlbWFpbDogdGhpcy5zdWJzY3JpYmVyQ29weS5lbWFpbCwNCiAgICAgICAgICBmaXJzdE5hbWU6ICcnLA0KICAgICAgICAgIGxhc3ROYW1lOiAnJywNCiAgICAgICAgICBpc0VuYWJsZWQ6IHRoaXMuc3Vic2NyaWJlckNvcHkuaXNFbmFibGVkLA0KICAgICAgICAgIGFydGljbGVDdXJzb3I6IHRoaXMuc3Vic2NyaWJlckNvcHkuYXJ0aWNsZUN1cnNvciwNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7DQogICAgICAgIGF4aW9zKHt1cmw6IEFQSV9FTkRQT0lOVFMuQURNSU5fVVBEQVRFX1NVQlNDUklCRVIsIGRhdGE6IGRhdGEsIG1ldGhvZDogJ1BVVCd9KQ0KICAgICAgICAgICAgLnRoZW4ocmVzcCA9PiB7DQogICAgICAgICAgICAgIHJlc29sdmUocmVzcCkNCiAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLnN1YnNjcmliZXIsIHJlc3AuZGF0YSkNCiAgICAgICAgICAgICAgdGhpcy4kZW1pdCgnc3Vic2NyaWJlclVwZGF0ZWQnLCByZXNwLmRhdGEpDQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgLmNhdGNoKCgpID0+IHsNCiAgICAgICAgICAgIH0pDQogICAgICB9KQ0KICAgIH0NCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICBPYmplY3QuYXNzaWduKHRoaXMuc3Vic2NyaWJlckNvcHksIHRoaXMuc3Vic2NyaWJlcikNCiAgICBpZiAodGhpcy5zdWJzY3JpYmVyQ29weS5pc0VuYWJsZWRMYWJlbCA9PSAiWWVzIiB8fCB0aGlzLnN1YnNjcmliZXIuaXNFbmFibGVkKSB7DQogICAgICB0aGlzLnN1YnNjcmliZXJDb3B5LmlzRW5hYmxlZCA9IHRydWUNCiAgICB9IGVsc2Ugew0KICAgICAgdGhpcy5zdWJzY3JpYmVyQ29weS5pc0VuYWJsZWQgPSBmYWxzZQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["AdminSubscriberCard.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AdminSubscriberCard.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <v-card flat class=\"mx-auto\">\r\n    <v-card-title class=\"headline grey lighten-2\">\r\n      <v-icon left color=\"black\">mdi-file-document-edit-outline</v-icon>\r\n      <h3 v-if=\"!subscriberCopy.email\">New Subscriber</h3>\r\n      <h3 v-else>Edit Subscriber</h3>\r\n    </v-card-title>\r\n    <v-container>\r\n      <br>\r\n      <v-flex xs12 sm12>\r\n        <v-text-field\r\n            label=\"Email Address\"\r\n            placeholder=\"New subscriber\"\r\n            outlined\r\n            :prepend-inner-icon=\"!isEditing ? 'mdi-pencil-plus-outline' : ''\"\r\n            v-model=\"subscriberCopy.email\"\r\n            :disabled=\"isEditing\"\r\n            :rules=\"emailRules\"\r\n            block\r\n            required\r\n        >\r\n        </v-text-field>\r\n      </v-flex>\r\n      <v-row xs12 class=\"mx-auto\" v-if=\"isEditing\">\r\n        <v-flex xs6 sm6 pr-1>\r\n          <v-text-field\r\n              label=\"Current Article\"\r\n              placeholder=\"Article No.\"\r\n              outlined\r\n              prepend-inner-icon=\"mdi-pencil-plus-outline\"\r\n              v-model.number=\"subscriberCopy.articleCursor\"\r\n              :rules=\"articleCursorRules\"\r\n              block\r\n              required\r\n          >\r\n          </v-text-field>\r\n        </v-flex>\r\n        <v-flex xs6 sm6 pl-1>\r\n          <v-select\r\n              v-model=\"subscriberCopy.isEnabled\"\r\n              :items=\"subscriberStatus\"\r\n              item-text=\"option\"\r\n              item-value=\"value\"\r\n              label=\"Status\"\r\n              block\r\n              outlined\r\n          ></v-select>\r\n        </v-flex>\r\n      </v-row>\r\n      <v-flex xs12 sm12>\r\n        <div id=\"message\" v-if=\"showMessage\"\r\n             class=\"intro-eleven-Description alert alert-dismissible fade show small success\"\r\n             role=\"alert\"\r\n        >\r\n          <button type=\"button\" class=\"close\" @click=\"showMessage=false\">\r\n            <span aria-hidden=\"true\">&times;</span>\r\n          </button>\r\n          <strong>{{displayedMessage}}</strong>\r\n        </div>\r\n      </v-flex>\r\n      <v-row class=\"mx-auto\">\r\n        <v-btn class=\"ma-1\" tile outlined color=\"info\" @click=\"close\">Cancel</v-btn>\r\n        <v-spacer></v-spacer>\r\n        <v-btn v-if=\"!isEditing\" class=\"ma-1\" tile color=\"info\" @click=\"add\" :disabled=\"!isEmailValid(subscriberCopy.email)\">Add</v-btn>\r\n        <v-btn v-else class=\"ma-1\" dark tile color=\"info\" @click=\"save\">Save</v-btn>\r\n      </v-row>\r\n    </v-container>\r\n  </v-card>\r\n</template>\r\n\r\n<script>\r\n\r\n\r\nimport axios from \"axios\";\r\nimport {default as API_ENDPOINTS} from \"@/api\";\r\n\r\nexport default {\r\n  name: \"SubscriberCard\",\r\n  components: {},\r\n  props: [\r\n    'projectId',\r\n    'email',\r\n    'subscriber',\r\n    'isEditing'\r\n  ],\r\n  data() {\r\n    return {\r\n      subscriberCopy: {},\r\n      emailRules: [\r\n        v => !!v || \"Required\",\r\n        v => /.+@.+\\..+/.test(v) || \"E-mail must be valid\"\r\n      ],\r\n      articleCursorRules: [\r\n        v => !!v || \"Required\",\r\n        v => /^\\d+$/.test(v) || \"Article No. must be a number\"\r\n      ],\r\n      showMessage: false,\r\n      displayedMessage: \"\",\r\n      subscriberStatus: [\r\n        {option: \"Enabled\", value: true},\r\n        {option: \"Disabled\", value: false}\r\n      ]\r\n    }\r\n  },\r\n  computed: {\r\n  },\r\n  methods: {\r\n    close() {\r\n      this.$emit('close')\r\n    },\r\n    closeShowMessage() {\r\n      setTimeout(() => {\r\n        this.showMessage = false\r\n      }, 6000)\r\n    },\r\n    isEmailValid(email) {\r\n      if (!(/.+@.+\\..+/.test(email))) {\r\n        return false\r\n      }\r\n      return true\r\n    },\r\n    isArticleCursorValid(articleNumber) {\r\n      if (!(/^\\d+$/.test(articleNumber))) {\r\n        return false\r\n      }\r\n      return true\r\n    },\r\n    save() {\r\n      if (!this.isArticleCursorValid(this.subscriberCopy.articleCursor)) {\r\n        return\r\n      }\r\n      this.saveSubscriber()\r\n    },\r\n    add() {\r\n      if (!this.isEmailValid(this.subscriberCopy.email)) {\r\n        return\r\n      }\r\n      this.subscribe()\r\n    },\r\n    subscribe() {\r\n      const data = {projectId: this.projectId, email: this.subscriberCopy.email, firstName: '', lastName: ''}\r\n      return new Promise((resolve) => {\r\n        axios({url: API_ENDPOINTS.CREATE_SUBSCRIBER, data: data, method: 'POST'})\r\n            .then(resp => {\r\n              resolve(resp)\r\n              this.displayedMessage = \"Subscribed successfully!\"\r\n              this.showMessage = true\r\n              this.subscriberCopy.email = \"\"\r\n              this.closeShowMessage()\r\n              this.$emit('subscriberAdded', (resp.data))\r\n            })\r\n            .catch(() => {\r\n              this.displayedMessage = \"Failed to subscribe.\"\r\n              this.showMessage = true\r\n              this.closeShowMessage()\r\n            })\r\n      })\r\n    },\r\n    saveSubscriber() {\r\n      const data = {\r\n        email: this.$store.getters.email, //admin email\r\n        editedSubscriber: {\r\n          projectId: this.projectId,\r\n          email: this.subscriberCopy.email,\r\n          firstName: '',\r\n          lastName: '',\r\n          isEnabled: this.subscriberCopy.isEnabled,\r\n          articleCursor: this.subscriberCopy.articleCursor,\r\n        }\r\n      }\r\n      return new Promise((resolve) => {\r\n        axios({url: API_ENDPOINTS.ADMIN_UPDATE_SUBSCRIBER, data: data, method: 'PUT'})\r\n            .then(resp => {\r\n              resolve(resp)\r\n              Object.assign(this.subscriber, resp.data)\r\n              this.$emit('subscriberUpdated', resp.data)\r\n            })\r\n            .catch(() => {\r\n            })\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    Object.assign(this.subscriberCopy, this.subscriber)\r\n    if (this.subscriberCopy.isEnabledLabel == \"Yes\" || this.subscriber.isEnabled) {\r\n      this.subscriberCopy.isEnabled = true\r\n    } else {\r\n      this.subscriberCopy.isEnabled = false\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]}]}