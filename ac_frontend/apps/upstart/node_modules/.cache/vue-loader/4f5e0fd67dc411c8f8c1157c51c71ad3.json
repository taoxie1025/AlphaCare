{"remainingRequest":"D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\src\\views\\Plan.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\src\\views\\Plan.vue","mtime":1604894028440},{"path":"D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Go\\src\\alphacare\\ac_frontend\\apps\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQoNCmltcG9ydCBQbGFuQ2FyZCBmcm9tICJAL2NvbXBvbmVudHMvUGxhbkNhcmQiOw0KaW1wb3J0IENoZWNrb3V0IGZyb20gIkAvY29tcG9uZW50cy9DaGVja291dENvbWZpcm0iOw0KaW1wb3J0IHtFdmVudEJ1cyBhcyBidXN9IGZyb20gIi4uL2V2ZW50X2J1cy5qcyINCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7DQppbXBvcnQge2RlZmF1bHQgYXMgQVBJX0VORFBPSU5UU30gZnJvbSAiQC9hcGkiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIGNvbXBvbmVudHM6IHtDaGVja291dCwgUGxhbkNhcmR9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBwbGFuczogWw0KICAgICAgICB7bmFtZTogIkZyZWUiLCBwcmljZTogIjAiLCBxdW90YTogIjEwMDAiLCB2YWx1ZTogMCwNCiAgICAgICAgICBpY29uOiByZXF1aXJlKCJAL2Fzc2V0cy9pbWFnZXMvbG9nb3MvZnJlZS1wbGFuLnBuZyIpLA0KICAgICAgICAgIGZlYXR1cmU6IFsNCiAgICAgICAgICAgIHtuYW1lOiAiTGFuZGluZyBwYWdlIiwgZW5hYmxlZDogdHJ1ZX0sDQogICAgICAgICAgICB7bmFtZTogIkFQSSAmIGV4dGVuc2lvbiBzdXBwb3J0IiwgZW5hYmxlZDogZmFsc2V9LA0KICAgICAgICAgICAge25hbWU6ICJEZXZlbG9wZXIgc3VwcG9ydCIsIGVuYWJsZWQ6IGZhbHNlfQ0KICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAge25hbWU6ICJQcm8iLCBwcmljZTogIjIwIiwgcXVvdGE6ICIxMDAsMDAwIiwgdmFsdWU6IDEsIHByaWNlSWQ6IHByb2Nlc3MuZW52LlZVRV9BUFBfUFJPX1BMQU5fUFJJQ0VfSUQsDQogICAgICAgICAgaWNvbjogcmVxdWlyZSgiQC9hc3NldHMvaW1hZ2VzL2xvZ29zL3Byby1wbGFuLnBuZyIpLA0KICAgICAgICAgIGZlYXR1cmU6IFsNCiAgICAgICAgICAgIHtuYW1lOiAiTGFuZGluZyBwYWdlIiwgZW5hYmxlZDogdHJ1ZX0sDQogICAgICAgICAgICB7bmFtZTogIkFQSSAmIGV4dGVuc2lvbiBzdXBwb3J0IiwgZW5hYmxlZDogdHJ1ZX0sDQogICAgICAgICAgICB7bmFtZTogIkRldmVsb3BlciBzdXBwb3J0IiwgZW5hYmxlZDogdHJ1ZX0sDQogICAgICAgICAgXX0sDQogICAgICAgIHtuYW1lOiAiVWx0cmEiLCBwcmljZTogIjYwIiwgcXVvdGE6ICIzMDAsMDAwIiwgdmFsdWU6IDIsIHByaWNlSWQ6IHByb2Nlc3MuZW52LlZVRV9BUFBfVUxUUkFfUExBTl9QUklDRV9JRCwNCiAgICAgICAgICBpY29uOiByZXF1aXJlKCJAL2Fzc2V0cy9pbWFnZXMvbG9nb3MvdWx0cmEtcGxhbi5wbmciKSwNCiAgICAgICAgICBmZWF0dXJlOiBbDQogICAgICAgICAgICB7bmFtZTogIkxhbmRpbmcgcGFnZSIsIGVuYWJsZWQ6IHRydWV9LA0KICAgICAgICAgICAge25hbWU6ICJBUEkgJiBleHRlbnNpb24gc3VwcG9ydCIsIGVuYWJsZWQ6IHRydWV9LA0KICAgICAgICAgICAge25hbWU6ICJEZXZlbG9wZXIgc3VwcG9ydCIsIGVuYWJsZWQ6IHRydWV9DQogICAgICAgICAgXX0NCiAgICAgIF0sDQogICAgICBjdXJyZW50UGxhbkluRGI6IC0xLA0KICAgICAgc2VsZWN0ZWRQbGFuOiAtMSwNCiAgICAgIGNoZWNrb3V0RGlhbG9nOiBmYWxzZSwNCiAgICAgIGl0ZW1zOiBbDQogICAgICAgIHsNCiAgICAgICAgICBza3U6ICdwcm9kX0k3V1F5ZWtPYmR4b01OJywNCiAgICAgICAgICBxdWFudGl0eTogMQ0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgc3RyaXBlOiB7fSwNCiAgICAgIHN0cmlwZVB1YmxpY0tleTogcHJvY2Vzcy5lbnYuVlVFX0FQUF9TVFJJUEVfUFVCTElDX0tFWSwNCiAgICAgIGFjY291bnRJbmZvOiB7fSwNCiAgICAgIHNuYWNrYmFyOiBmYWxzZSwNCiAgICAgIHF1aWNrTWVzc2FnZTogIiIsDQogICAgfQ0KICB9LA0KICB3YXRjaDogew0KICB9LA0KICBtZXRob2RzOiB7DQogICAgc2hvd1F1aWNrTWVzc2FnZShtc2cpIHsNCiAgICAgIHRoaXMucXVpY2tNZXNzYWdlID0gbXNnDQogICAgICB0aGlzLnNuYWNrYmFyID0gdHJ1ZQ0KICAgIH0sDQogICAgdW5zdWJzY3JpYmUoKSB7DQogICAgICB0aGlzLmNhbmNlbFN1YnNjcmlwdGlvbigpDQogICAgfSwNCiAgICBjYW5jZWxTdWJzY3JpcHRpb24oKSB7DQogICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gew0KICAgICAgICBjb25zdCBkYXRhID0ge3JlcXVlc3RlckVtYWlsOiB0aGlzLiRzdG9yZS5nZXR0ZXJzLmVtYWlsfQ0KICAgICAgICBheGlvcyh7dXJsOiBBUElfRU5EUE9JTlRTLkNBTkNFTF9TVUJTQ1JJUFRJT04odGhpcy4kc3RvcmUuZ2V0dGVycy5lbWFpbCwgdGhpcy5hY2NvdW50SW5mby5zdWJzY3JpcHRpb25JZCksIHBhcmFtczogZGF0YSwgbWV0aG9kOiAnREVMRVRFJ30pDQogICAgICAgICAgICAudGhlbihyZXNwID0+IHsNCiAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwKQ0KICAgICAgICAgICAgICB0aGlzLnJlYWRBY2NvdW50SW5mbygpDQogICAgICAgICAgICAgIHRoaXMuY2hlY2tvdXREaWFsb2cgPSBmYWxzZQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gew0KICAgICAgICAgICAgICByZWplY3QoZXJyKQ0KICAgICAgICAgICAgfSkNCiAgICAgIH0pDQogICAgfSwNCiAgICBjYW5jZWwoKSB7DQogICAgICB0aGlzLnNlbGVjdGVkUGxhbiA9IHRoaXMuY3VycmVudFBsYW5JbkRiDQogICAgICB0aGlzLmNoZWNrb3V0RGlhbG9nID0gZmFsc2UNCiAgICB9LA0KICAgIGNoZWNrb3V0KCkgew0KICAgICAgYnVzLiRlbWl0KCdwcm9jZWVkVG9DaGVja291dCcpDQogICAgfSwNCiAgICBjaGFuZ2VTZWxlY3RlZFBsYW4oaW5kZXgpIHsNCiAgICAgIHRoaXMuc2VsZWN0ZWRQbGFuID0gaW5kZXgNCiAgICAgIGlmICh0aGlzLnNlbGVjdGVkUGxhbiA9PSB0aGlzLmN1cnJlbnRQbGFuSW5EYikgew0KICAgICAgICByZXR1cm4NCiAgICAgIH0NCiAgICAgIHRoaXMuY2hlY2tvdXREaWFsb2cgPSB0cnVlDQogICAgfSwNCiAgICB2YWxpZGF0ZUxvZ2luKCkgew0KICAgICAgaWYgKCF0aGlzLiRzdG9yZS5nZXR0ZXJzLmlzTG9nZ2VkSW4gfHwgIXRoaXMuJHN0b3JlLmdldHRlcnMuZW1haWwpIHsNCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy8nKQ0KICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgIH0NCiAgICAgIHJldHVybiB0cnVlDQogICAgfSwNCiAgICByZWFkQWNjb3VudEluZm8oKSB7DQogICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gew0KICAgICAgICBjb25zdCBkYXRhID0ge3JlcXVlc3RlckVtYWlsOiB0aGlzLiRzdG9yZS5nZXR0ZXJzLmVtYWlsfQ0KICAgICAgICBheGlvcyh7dXJsOiBBUElfRU5EUE9JTlRTLlJFQURfQUNDT1VOVF9JTkZPKHRoaXMuJHN0b3JlLmdldHRlcnMuZW1haWwpLCBwYXJhbXM6IGRhdGEsIG1ldGhvZDogJ0dFVCd9KQ0KICAgICAgICAgICAgLnRoZW4ocmVzcCA9PiB7DQogICAgICAgICAgICAgIHJlc29sdmUocmVzcCkNCiAgICAgICAgICAgICAgdGhpcy5hY2NvdW50SW5mbyA9IHJlc3AuZGF0YQ0KICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQbGFuSW5EYiA9IHRoaXMuYWNjb3VudEluZm8uc3Vic2NyaXB0aW9uUGxhbg0KICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUGxhbiA9IHRoaXMuY3VycmVudFBsYW5JbkRiDQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7DQogICAgICAgICAgICAgIHJlamVjdChlcnIpDQogICAgICAgICAgICB9KQ0KICAgICAgfSkNCiAgICB9DQogIH0sDQogIGNyZWF0ZWQ6IGZ1bmN0aW9uICgpIHsNCiAgICB0aGlzLnZhbGlkYXRlTG9naW4oKQ0KICAgIHRoaXMucmVhZEFjY291bnRJbmZvKCkNCiAgICBpZiAodGhpcy4kcm91dGUucXVlcnkuc3RhdHVzID09ICJvayIpIHsNCiAgICAgIHRoaXMuc2hvd1F1aWNrTWVzc2FnZSgiUGF5bWVudCBzdWNjZWVkZWQuIikNCiAgICB9IGVsc2UgaWYgKHRoaXMuJHJvdXRlLnF1ZXJ5LnNob3dTdGF0dXMgPT0gImZhaWxlZCIpIHsNCiAgICAgIHRoaXMuc2hvd1F1aWNrTWVzc2FnZSgiUGF5bWVudCBmYWlsZWQsIHBsZWFzZSB0cnkgYWdhaW4uIikNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["Plan.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Plan.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <v-app id=\"app\">\r\n    <v-container fluid>\r\n      <v-layout row wrap>\r\n        <v-flex xs12 sm12 md6 lg4 v-for=\"(plan, index) in plans\" v-bind:key=\"plan.value\">\r\n          <div @click=\"changeSelectedPlan(index)\">\r\n            <plan-card :plan=\"plan\" :selectedPlan=\"selectedPlan\" class=\"ma-3\"></plan-card>\r\n          </div>\r\n        </v-flex>\r\n      </v-layout>\r\n      <v-layout>\r\n        <v-row justify=\"center\">\r\n          <v-dialog persistent v-model=\"checkoutDialog\" max-width=\"350\">\r\n            <v-card>\r\n              <v-card-title class=\"headline grey lighten-2\">\r\n                <h3 v-if=\"selectedPlan>0\">Change to {{plans[selectedPlan].name}} plan?</h3>\r\n                <h3 v-else>Are you sure to unsubscribe?</h3>\r\n              </v-card-title>\r\n              <v-layout>\r\n                <checkout class=\"mt-2\" :plan=\"plans[selectedPlan]\" :accountInfo=\"accountInfo\" @closeDialog=\"checkoutDialog=false\"></checkout>\r\n              </v-layout>\r\n              <v-container>\r\n                <v-row class=\"mx-auto\">\r\n                  <v-btn class=\"ma-1\" tile outlined color=\"info\" @click=\"cancel\">Cancel</v-btn>\r\n                  <v-spacer></v-spacer>\r\n                  <v-btn v-if=\"selectedPlan>0 && accountInfo.subscriptionId==''\" class=\"ma-1\" dark tile color=\"info\" @click=\"checkout\">Checkout</v-btn>\r\n                  <v-btn v-else-if=\"selectedPlan>0 && accountInfo.subscriptionId!=''\" class=\"ma-1\" dark tile color=\"info\" @click=\"checkout\">Change</v-btn>\r\n                  <v-btn v-else class=\"ma-1\" tile outlined color=\"info\" @click=\"unsubscribe\">Yes</v-btn>\r\n                </v-row>\r\n              </v-container>\r\n            </v-card>\r\n          </v-dialog>\r\n        </v-row>\r\n        <v-row>\r\n          <v-snackbar v-model=\"snackbar\" timeout=\"3000\" @click=\"snackbar=false\">\r\n            {{quickMessage}}\r\n            <template v-slot:action=\"{ attrs }\">\r\n              <v-btn\r\n                  color=\"pink\"\r\n                  text\r\n                  v-bind=\"attrs\"\r\n                  @click=\"snackbar = false\"\r\n              >\r\n                Close\r\n              </v-btn>\r\n            </template>\r\n          </v-snackbar>\r\n        </v-row>\r\n      </v-layout>\r\n    </v-container>\r\n  </v-app>\r\n</template>\r\n<script>\r\n\r\nimport PlanCard from \"@/components/PlanCard\";\r\nimport Checkout from \"@/components/CheckoutComfirm\";\r\nimport {EventBus as bus} from \"../event_bus.js\"\r\nimport axios from \"axios\";\r\nimport {default as API_ENDPOINTS} from \"@/api\";\r\n\r\nexport default {\r\n  components: {Checkout, PlanCard},\r\n  data() {\r\n    return {\r\n      plans: [\r\n        {name: \"Free\", price: \"0\", quota: \"1000\", value: 0,\r\n          icon: require(\"@/assets/images/logos/free-plan.png\"),\r\n          feature: [\r\n            {name: \"Landing page\", enabled: true},\r\n            {name: \"API & extension support\", enabled: false},\r\n            {name: \"Developer support\", enabled: false}\r\n          ]\r\n        },\r\n        {name: \"Pro\", price: \"20\", quota: \"100,000\", value: 1, priceId: process.env.VUE_APP_PRO_PLAN_PRICE_ID,\r\n          icon: require(\"@/assets/images/logos/pro-plan.png\"),\r\n          feature: [\r\n            {name: \"Landing page\", enabled: true},\r\n            {name: \"API & extension support\", enabled: true},\r\n            {name: \"Developer support\", enabled: true},\r\n          ]},\r\n        {name: \"Ultra\", price: \"60\", quota: \"300,000\", value: 2, priceId: process.env.VUE_APP_ULTRA_PLAN_PRICE_ID,\r\n          icon: require(\"@/assets/images/logos/ultra-plan.png\"),\r\n          feature: [\r\n            {name: \"Landing page\", enabled: true},\r\n            {name: \"API & extension support\", enabled: true},\r\n            {name: \"Developer support\", enabled: true}\r\n          ]}\r\n      ],\r\n      currentPlanInDb: -1,\r\n      selectedPlan: -1,\r\n      checkoutDialog: false,\r\n      items: [\r\n        {\r\n          sku: 'prod_I7WQyekObdxoMN',\r\n          quantity: 1\r\n        }\r\n      ],\r\n      stripe: {},\r\n      stripePublicKey: process.env.VUE_APP_STRIPE_PUBLIC_KEY,\r\n      accountInfo: {},\r\n      snackbar: false,\r\n      quickMessage: \"\",\r\n    }\r\n  },\r\n  watch: {\r\n  },\r\n  methods: {\r\n    showQuickMessage(msg) {\r\n      this.quickMessage = msg\r\n      this.snackbar = true\r\n    },\r\n    unsubscribe() {\r\n      this.cancelSubscription()\r\n    },\r\n    cancelSubscription() {\r\n      return new Promise((resolve, reject) => {\r\n        const data = {requesterEmail: this.$store.getters.email}\r\n        axios({url: API_ENDPOINTS.CANCEL_SUBSCRIPTION(this.$store.getters.email, this.accountInfo.subscriptionId), params: data, method: 'DELETE'})\r\n            .then(resp => {\r\n              resolve(resp)\r\n              this.readAccountInfo()\r\n              this.checkoutDialog = false\r\n            })\r\n            .catch(err => {\r\n              reject(err)\r\n            })\r\n      })\r\n    },\r\n    cancel() {\r\n      this.selectedPlan = this.currentPlanInDb\r\n      this.checkoutDialog = false\r\n    },\r\n    checkout() {\r\n      bus.$emit('proceedToCheckout')\r\n    },\r\n    changeSelectedPlan(index) {\r\n      this.selectedPlan = index\r\n      if (this.selectedPlan == this.currentPlanInDb) {\r\n        return\r\n      }\r\n      this.checkoutDialog = true\r\n    },\r\n    validateLogin() {\r\n      if (!this.$store.getters.isLoggedIn || !this.$store.getters.email) {\r\n        this.$router.push('/')\r\n        return false\r\n      }\r\n      return true\r\n    },\r\n    readAccountInfo() {\r\n      return new Promise((resolve, reject) => {\r\n        const data = {requesterEmail: this.$store.getters.email}\r\n        axios({url: API_ENDPOINTS.READ_ACCOUNT_INFO(this.$store.getters.email), params: data, method: 'GET'})\r\n            .then(resp => {\r\n              resolve(resp)\r\n              this.accountInfo = resp.data\r\n              this.currentPlanInDb = this.accountInfo.subscriptionPlan\r\n              this.selectedPlan = this.currentPlanInDb\r\n            })\r\n            .catch(err => {\r\n              reject(err)\r\n            })\r\n      })\r\n    }\r\n  },\r\n  created: function () {\r\n    this.validateLogin()\r\n    this.readAccountInfo()\r\n    if (this.$route.query.status == \"ok\") {\r\n      this.showQuickMessage(\"Payment succeeded.\")\r\n    } else if (this.$route.query.showStatus == \"failed\") {\r\n      this.showQuickMessage(\"Payment failed, please try again.\")\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n\r\n<style>\r\n\r\n</style>\r\n"]}]}